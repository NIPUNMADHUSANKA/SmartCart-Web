<div class="home">

    <!-- Summary -->
    <section class="card">
        <h2 class="card__title">{{homePageTitle() | titlecase}}</h2>
        <p class="muted">Overview of your current shopping activity</p>
        <div class="stats">
            <div class="stat">
                <div class="stat__value">{{totalCategories$ | async}}</div>
                <div class="stat__label"><mat-icon class="home-icon">folder</mat-icon>Total Categories</div>
            </div>
            <div class="stat">
                <div class="stat__value">{{openCategories$ | async}}</div>
                <div class="stat__label"><mat-icon class="home-icon">hourglass_empty</mat-icon>Open Categories</div>
            </div>
            <div class="stat">
                <div class="stat__value">{{completedCategories$ | async }}</div>
                <div class="stat__label"><mat-icon class="home-icon">done</mat-icon>Completed Categories</div>
            </div>
            <div class="stat">
                <div class="stat__value">{{totalItems$ | async}}</div>
                <div class="stat__label"><mat-icon class="home-icon">shopping_bag</mat-icon>Pending Items</div>
            </div>
        </div>
    </section>

    <!-- Active Categories -->
    <section class="card">
        <div class="card__header">
            <h2 class="card__title">{{homePageSubTitle() | titlecase}}</h2>
        </div>

        <div class="list">
            <!-- Category Card -->
            @if (allactiveCategory$ | async; as categories) {
                @if (categories.length > 0) {
                    @for (item of categories; track item.categoryId) {
                        <article class="category">
                            <div class="category__main">
                                <div class="category__top">
                                    <span class="pill pill--open">Open</span>
                                    <h3 class="category__title">{{item.categoryName}}</h3>
                                </div>

                                <div class="category__meta">
                                    <span class="category__progressText"> {{item.openItems}} / {{item.totalItems}} items completed</span>
                                </div>

                                <div class="progress" aria-label="Groceries progress">
                                    <div class="progress__bar"  [style.width.%]="item.openPre"></div>
                                </div>
                            </div>

                            <button class="btn btn--link" type="button" aria-label="Continue Groceries" (click)="continueButton()">
                                Continue â†’
                            </button>
                        </article>
                    }
                }
                @else {
                    <p class="muted muted-state">No active shopping lists. Start a new one.</p>
                    <button class="btn btn--link btn--new" type="button" aria-label="Continue Groceries" (click)="continueButton()">
                                Create Shopping List
                    </button>
                }
            }
            
        </div>
    </section>

    <!-- Completed Categories -->
    <section class="card">
        <details class="details" open>
            <summary class="details__summary">
                <span class="details__title">Completed Categories</span>
                <span class="details__count">{{completedCategories$ | async }}</span>
            </summary>
            @for (item of allCompletedCategory$ |async; track $index) {
                <ul class="completed">
                    <li class="completed__item">
                        <span class="pill pill--done">Done</span>
                        <span class="completed__name">{{item.categoryName}}</span>
                    </li>
                </ul>
            }
            <p class="muted">Completed categories are read-only here.</p>
        </details>
    </section>
</div>